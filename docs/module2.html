<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Working with Files, Text, and Output – NWU_2025_Workshop</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">NWU_2025_Workshop</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./module0.html"> 
<span class="menu-text">Module 0: Setup</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./module1.html"> 
<span class="menu-text">Module 1: Bash terminal basics</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#files-and-file-extensions" id="toc-files-and-file-extensions" class="nav-link active" data-scroll-target="#files-and-file-extensions">Files and File Extensions</a>
  <ul class="collapse">
  <li><a href="#why-are-file-extensions-important" id="toc-why-are-file-extensions-important" class="nav-link" data-scroll-target="#why-are-file-extensions-important">Why Are File Extensions Important?</a></li>
  </ul></li>
  <li><a href="#plain-text-files-and-file-formats-in-bioinformatics" id="toc-plain-text-files-and-file-formats-in-bioinformatics" class="nav-link" data-scroll-target="#plain-text-files-and-file-formats-in-bioinformatics">Plain Text Files and File Formats in Bioinformatics</a>
  <ul class="collapse">
  <li><a href="#what-is-plain-text" id="toc-what-is-plain-text" class="nav-link" data-scroll-target="#what-is-plain-text">What is Plain Text?</a></li>
  <li><a href="#common-file-formats-in-bioinformatics" id="toc-common-file-formats-in-bioinformatics" class="nav-link" data-scroll-target="#common-file-formats-in-bioinformatics">Common File Formats in Bioinformatics</a></li>
  <li><a href="#fasta-plain-text" id="toc-fasta-plain-text" class="nav-link" data-scroll-target="#fasta-plain-text">1. <strong>FASTA (Plain Text)</strong></a></li>
  <li><a href="#fastq-plain-text" id="toc-fastq-plain-text" class="nav-link" data-scroll-target="#fastq-plain-text">2. <strong>FASTQ (Plain Text)</strong></a></li>
  <li><a href="#sambam-plain-text-vs.-binary" id="toc-sambam-plain-text-vs.-binary" class="nav-link" data-scroll-target="#sambam-plain-text-vs.-binary">3. <strong>SAM/BAM (Plain Text vs.&nbsp;Binary)</strong></a></li>
  <li><a href="#vcf-variant-call-format" id="toc-vcf-variant-call-format" class="nav-link" data-scroll-target="#vcf-variant-call-format">4. <strong>VCF (Variant Call Format)</strong></a></li>
  </ul></li>
  <li><a href="#working-with-bioinformatics-file-formats-in-the-terminal" id="toc-working-with-bioinformatics-file-formats-in-the-terminal" class="nav-link" data-scroll-target="#working-with-bioinformatics-file-formats-in-the-terminal">Working with Bioinformatics File Formats in the Terminal</a>
  <ul class="collapse">
  <li><a href="#standard-output-redirection-with-bioinformatics-files" id="toc-standard-output-redirection-with-bioinformatics-files" class="nav-link" data-scroll-target="#standard-output-redirection-with-bioinformatics-files">Standard Output Redirection with Bioinformatics Files</a></li>
  </ul></li>
  <li><a href="#using-grep-sed-and-piping-in-bioinformatics-workflows" id="toc-using-grep-sed-and-piping-in-bioinformatics-workflows" class="nav-link" data-scroll-target="#using-grep-sed-and-piping-in-bioinformatics-workflows">Using <code>grep</code>, <code>sed</code>, and Piping in Bioinformatics Workflows</a>
  <ul class="collapse">
  <li><a href="#extracting-variants-from-a-vcf-file" id="toc-extracting-variants-from-a-vcf-file" class="nav-link" data-scroll-target="#extracting-variants-from-a-vcf-file">1. Extracting Variants from a VCF File</a></li>
  <li><a href="#counting-specific-alleles-in-a-vcf-file" id="toc-counting-specific-alleles-in-a-vcf-file" class="nav-link" data-scroll-target="#counting-specific-alleles-in-a-vcf-file">2. Counting Specific Alleles in a VCF File</a></li>
  <li><a href="#cleaning-a-vcf-file" id="toc-cleaning-a-vcf-file" class="nav-link" data-scroll-target="#cleaning-a-vcf-file">3. Cleaning a VCF File</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Working with Files, Text, and Output</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="files-and-file-extensions" class="level2">
<h2 class="anchored" data-anchor-id="files-and-file-extensions">Files and File Extensions</h2>
<p>Every file on your computer has a <strong>file extension</strong>, which is part of its name and comes after the last period (dot) in the filename. For example, in <code>document.txt</code>, <code>.txt</code> is the file extension.</p>
<p>File extensions are used by the operating system to determine what kind of file it is, what program should open it, and how it should be processed. Some common file extensions include:</p>
<ul>
<li><code>.txt</code> – Plain text file</li>
<li><code>.docx</code> – Microsoft Word document</li>
<li><code>.pdf</code> – PDF document</li>
<li><code>.jpg</code> – JPEG image file</li>
<li><code>.sh</code> – Shell script</li>
</ul>
<section id="why-are-file-extensions-important" class="level3">
<h3 class="anchored" data-anchor-id="why-are-file-extensions-important">Why Are File Extensions Important?</h3>
<p>File extensions are important because they help the system identify how to handle a file. For example: - A <code>.txt</code> file is usually opened with a simple text editor (e.g., Notepad, VSCode, etc.). - A <code>.docx</code> file is typically opened in Microsoft Word or similar word processing software.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The extension does not determine the content of a file, just how it is generally interpreted by the system. You can change a file extension, but it doesn’t change the underlying content type though it might prevent the file from being opened correctly. For example you can change the extension of a <code>.jpg</code> image to <code>.txt</code> , but that doesn’t mean you can open it in Notepad as it will still be an image.</p>
</div>
</div>
</section>
</section>
<section id="plain-text-files-and-file-formats-in-bioinformatics" class="level2">
<h2 class="anchored" data-anchor-id="plain-text-files-and-file-formats-in-bioinformatics">Plain Text Files and File Formats in Bioinformatics</h2>
<section id="what-is-plain-text" class="level3">
<h3 class="anchored" data-anchor-id="what-is-plain-text">What is Plain Text?</h3>
<p><strong>Plain text</strong> files contain only characters. There are no special formatting, images, or embedded metadata.</p>
<p><strong>Plain text</strong> is UNIVERSAL. It is not a proprietary format that can only be read by specific programme (for example, <code>.docx</code>). Any text editor across any system can read and manipulate plain text files.</p>
<p>In bioinformatics, <strong>plain text</strong> files are preferred for storing data because they can be easily read, processed, and manipulated by a variety of different software.</p>
<p>However, not all bioinformatics data comes in plain text. Many data formats are designed for efficient storage, performance, or specific analysis tasks, and they may be <strong>binary formats</strong> (e.g., BAM). In bioinformatics workflows, <strong>plain text</strong> formats are still commonly used for various data exchange and reporting.</p>
</section>
<section id="common-file-formats-in-bioinformatics" class="level3">
<h3 class="anchored" data-anchor-id="common-file-formats-in-bioinformatics">Common File Formats in Bioinformatics</h3>
<p>Here are some of the most common file formats used in bioinformatics:</p>
<hr>
</section>
<section id="fasta-plain-text" class="level3">
<h3 class="anchored" data-anchor-id="fasta-plain-text">1. <strong>FASTA (Plain Text)</strong></h3>
<p>FASTA is one of the most widely used formats for representing <strong>biological sequences</strong>, such as DNA, RNA, or protein sequences. A FASTA file consists of multiple sequences, each starting with a description line (prefixed by a <code>&gt;</code>), followed by the sequence itself.</p>
<p><strong>Example FASTA Format</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>&gt;seq1</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>ATGCGTACGTAGCTAGCTGATCGTAGCTGACTGATCGTAGC</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>&gt;seq2</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>GTAGCTAGGCTAGCTAGCTAGTAGGCTAGGAGTAGAGCTAG</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Description line</strong>: Starts with <code>&gt;</code>, followed by an identifier and optional description.</li>
<li><strong>Sequence</strong>: The actual sequence of nucleotides (DNA) or amino acids (protein).</li>
</ul>
<p><strong>Use Case</strong>: FASTA files are often used to store reference genomes, transcript sequences, or protein sequences.</p>
<hr>
</section>
<section id="fastq-plain-text" class="level3">
<h3 class="anchored" data-anchor-id="fastq-plain-text">2. <strong>FASTQ (Plain Text)</strong></h3>
<p>The <strong>FASTQ</strong> format is an extension of the FASTA format, used for storing raw sequence data <strong>with quality scores</strong>. Each entry contains four lines:</p>
<ol type="1">
<li><strong>Header</strong>: Starts with <code>@</code> followed by the sequence identifier.</li>
<li><strong>Sequence</strong>: The actual sequence of nucleotides (e.g., DNA sequence).</li>
<li><strong>Plus line</strong>: A <code>+</code> sign.</li>
<li><strong>Quality scores</strong>: Encoded as ASCII characters representing the quality of each base.</li>
</ol>
<p><strong>Example FASTQ Format</strong>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>@seq1</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>ATGCGTACGTAGCTAGCTGATCGTAGCTGACTGATCGTAGC</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>@seq2</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>GTAGCTAGGCTAGCTAGCTAGTAGGCTAGGAGTAGAGCTAG</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>+</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>The quality score lines represent the reliability of each base, encoded in a way that ranges from high to low confidence.</li>
</ul>
<p><strong>Use Case</strong>: FASTQ files are the output of high-throughput sequencing technologies like Illumina and Nanopore. They are often used in raw sequence analysis, quality control, and alignment steps.</p>
<hr>
</section>
<section id="sambam-plain-text-vs.-binary" class="level3">
<h3 class="anchored" data-anchor-id="sambam-plain-text-vs.-binary">3. <strong>SAM/BAM (Plain Text vs.&nbsp;Binary)</strong></h3>
<ul>
<li><strong>SAM</strong> (Sequence Alignment/Map) is a <strong>plain text</strong> format for storing information about sequence alignment. It contains information about the alignment of sequences to a reference genome, including positions, CIGAR strings, mapping quality, and more.</li>
<li><strong>BAM</strong> is the <strong>binary</strong> equivalent of SAM, designed for efficient storage and quick access.</li>
</ul>
<p><strong>Example SAM Format</strong>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>@SQ   SN:seq1 LN:1000</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>r001  99  seq1  1  60  8S12M1S  * 0  0  GATCGGAAGAGC  *</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>r002  0   seq1  2  60  10M  * 0  0  CCTGGAAGAGC  *</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Use Case</strong>: SAM/BAM files store <strong>mapped sequence data</strong> (e.g., after aligning FASTQ reads to a reference genome). They are used in downstream bioinformatics analysis like variant calling or visualization in genome browsers.</p>
<hr>
</section>
<section id="vcf-variant-call-format" class="level3">
<h3 class="anchored" data-anchor-id="vcf-variant-call-format">4. <strong>VCF (Variant Call Format)</strong></h3>
<p>VCF is a <strong>plain text</strong> format used to store <strong>genetic variation data</strong> (e.g., SNPs, indels). It contains metadata and a table of variant calls for each sample at each position in the genome.</p>
<p><strong>Example VCF Format</strong>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode txt code-with-copy"><code class="sourceCode default"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>##fileformat=VCFv4.2</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>##reference=GRCh37</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>#CHROM POS ID REF ALT QUAL FILTER INFO</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>chr1  101  rs12345 A  G  50  PASS  DP=100;AF=0.45</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>chr1  202  rs67890 T  C  60  PASS  DP=80;AF=0.60</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>Header lines</strong>: Provide metadata, such as the reference genome.</li>
<li><strong>Data lines</strong>: Contain information about each variant, including chromosome, position, reference allele, alternate allele, and quality metrics.</li>
</ul>
<p><strong>Use Case</strong>: VCF files are commonly used to store <strong>variant calls</strong> from sequencing data after alignment and variant calling.</p>
<hr>
</section>
</section>
<section id="working-with-bioinformatics-file-formats-in-the-terminal" class="level2">
<h2 class="anchored" data-anchor-id="working-with-bioinformatics-file-formats-in-the-terminal">Working with Bioinformatics File Formats in the Terminal</h2>
<p>Now that we understand some common bioinformatics file formats, let’s explore how to manipulate and extract useful information from these files using basic shell commands, like <code>grep</code>, <code>sed</code>, and redirection.</p>
<section id="standard-output-redirection-with-bioinformatics-files" class="level3">
<h3 class="anchored" data-anchor-id="standard-output-redirection-with-bioinformatics-files">Standard Output Redirection with Bioinformatics Files</h3>
<section id="counting-contigs-in-a-fasta-file" class="level4">
<h4 class="anchored" data-anchor-id="counting-contigs-in-a-fasta-file">1. Counting Contigs in a FASTA File</h4>
<p>The <code>grep</code> command can be used to count the number of contigs (or sequences) in a FASTA file. Each sequence in a FASTA file starts with a description line (<code>&gt;</code>), so we can count the number of <code>&gt;</code> symbols to determine how many sequences (contigs) there are.</p>
<ul>
<li><strong>Count the number of sequences in a FASTA file</strong>:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-c</span> <span class="st">"&gt;"</span> sequences.fasta</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This command counts how many lines start with <code>&gt;</code>, which indicates the number of sequences in the file.</p>
</section>
<section id="extracting-sequence-names-from-a-fasta-file" class="level4">
<h4 class="anchored" data-anchor-id="extracting-sequence-names-from-a-fasta-file">2. Extracting Sequence Names from a FASTA File</h4>
<p>If you want to list just the sequence names (the lines starting with <code>&gt;</code>), you can use <code>grep</code> to extract them.</p>
<ul>
<li><strong>Extract sequence names (headers)</strong> from a FASTA file:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="st">"&gt;"</span> sequences.fasta <span class="op">&gt;</span> sequence_names.txt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This command will save all sequence names (headers) to <code>sequence_names.txt</code>.</p>
</section>
<section id="working-with-quality-scores-in-fastq" class="level4">
<h4 class="anchored" data-anchor-id="working-with-quality-scores-in-fastq">3. Working with Quality Scores in FASTQ</h4>
<p>If you want to extract specific quality scores or sequences from a FASTQ file, you can use <code>grep</code> and <code>sed</code> for pattern matching and modification.</p>
<ul>
<li><strong>Extract sequences that contain a specific nucleotide</strong> (e.g., “A”) in a FASTQ file:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-B</span> 1 <span class="st">"A"</span> sample.fastq <span class="kw">|</span> <span class="fu">grep</span> <span class="at">-v</span> <span class="st">"^+"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This command looks for sequences containing “A” and shows the associated headers and quality scores.</p>
</section>
<section id="modifying-quality-scores-with-sed" class="level4">
<h4 class="anchored" data-anchor-id="modifying-quality-scores-with-sed">4. Modifying Quality Scores with <code>sed</code></h4>
<p>Suppose you want to <strong>replace low-quality base calls</strong> (represented by a specific ASCII character) in a FASTQ file.</p>
<ul>
<li><strong>Replace low-quality base calls in a FASTQ file</strong> (assuming <code>I</code> is a low-quality base):</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sed</span> <span class="st">'s/I/N/g'</span> input.fastq <span class="op">&gt;</span> modified.fastq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This command replaces all occurrences of <code>I</code> with <code>N</code> in <code>input.fastq</code> and saves the result to <code>modified.fastq</code>.</p>
<hr>
</section>
</section>
</section>
<section id="using-grep-sed-and-piping-in-bioinformatics-workflows" class="level2">
<h2 class="anchored" data-anchor-id="using-grep-sed-and-piping-in-bioinformatics-workflows">Using <code>grep</code>, <code>sed</code>, and Piping in Bioinformatics Workflows</h2>
<section id="extracting-variants-from-a-vcf-file" class="level3">
<h3 class="anchored" data-anchor-id="extracting-variants-from-a-vcf-file">1. Extracting Variants from a VCF File</h3>
<p>If you want to <strong>filter</strong> and <strong>extract</strong> specific variants from a VCF file, you can use <code>grep</code> or <code>awk</code>. For example, to extract variants from a specific chromosome:</p>
<ul>
<li><strong>Extract variants from chromosome 1</strong>:</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="st">"^chr1"</span> variants.vcf <span class="op">&gt;</span> chr1_variants.vcf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can also combine commands using <strong>piping</strong> (<code>|</code>).</p>
</section>
<section id="counting-specific-alleles-in-a-vcf-file" class="level3">
<h3 class="anchored" data-anchor-id="counting-specific-alleles-in-a-vcf-file">2. Counting Specific Alleles in a VCF File</h3>
<p>Let’s say you want to <strong>count</strong> the number of variants with a specific <strong>allele</strong> (e.g., alternate allele <code>G</code>).</p>
<ul>
<li><strong>Count the number of variants with the <code>G</code> allele</strong> in a VCF file:</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-c</span> <span class="st">"G"</span> variants.vcf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="cleaning-a-vcf-file" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-a-vcf-file">3. Cleaning a VCF File</h3>
<p>You might want to <strong>remove comments</strong> or unnecessary lines from a VCF file. You can use <code>grep</code> with the <code>-v</code> option to exclude comment lines.</p>
<ul>
<li><strong>Remove comment lines from a VCF file</strong>:</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span> <span class="at">-v</span> <span class="st">"^#"</span> variants.vcf <span class="op">&gt;</span> clean_variants.vcf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This removes all lines that start with <code>#</code>, which are typically comments in VCF files.</p>
<hr>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>